/*
 * ERPNext / Frappe â€” Project Management Theme
 * Drag-drop safe for Website + Desk. Dark/Light via [data-theme].
 * Non-destructive: only styling + progressive enhancements.
 */

/* =========================
   THEME TOKENS
   ========================= */
:root {
  /* brand */
  --pm-primary: #0074bf;
  --pm-primary-600: #0466a6;
  --pm-secondary: #4a8ce2;

  /* surfaces */
  --pm-surface: #ffffff;
  --pm-bg: #e5e8eb;
  --pm-border: #d6dde6;
  --pm-shadow: 0 6px 12px -2px rgba(50,50,93,.25), 0 3px 7px -3px rgba(0,0,0,.3);

  /* text */
  --pm-text: #111111;
  --pm-text-muted: #5b6370;

  /* status colors */
  --pm-status-backlog: #a0aec0;
  --pm-status-todo: #6366f1;
  --pm-status-inprogress: #f59e0b;
  --pm-status-review: #06b6d4;
  --pm-status-blocked: #ef4444;
  --pm-status-done: #22c55e;

  /* priorities */
  --pm-pri-low: #10b981;
  --pm-pri-med: #f59e0b;
  --pm-pri-high: #ef4444;

  /* radii + spacing */
  --pm-radius-sm: .375rem;
  --pm-radius-md: .625rem;
  --pm-radius-lg: .875rem;
  --pm-gap-sm: .375rem;
  --pm-gap-md: .75rem;
  --pm-gap-lg: 1rem;

  /* font sizes */
  --pm-font-size-xs: 11px;
  --pm-font-size-sm: 12px;
  --pm-font-size: 14px;
  --pm-font-size-lg: 16px;

  /* compatibility with existing variables used in ERPNext themes */
  --bg-color: var(--pm-bg);
  --background: var(--pm-surface);
  --text-color-2: var(--pm-text);
  --main-text-color: var(--pm-primary);
  --navbar-bg-2: #171717;
  --table-border-color-2: #0073bf57;
  --card-background: rgba(0,116,191,.11);
  --sidebar-select-color-2: rgba(1,95,132,.16);
  --text-btn-color: #fff;
}

[data-theme="dark"] {
  --pm-primary: #4aa8e6;
  --pm-primary-600: #3096dc;
  --pm-secondary: #7fb1ff;

  --pm-surface: #1f1f1f;
  --pm-bg: #131316;
  --pm-border: #2b2f36;

  --pm-text: #efefef;
  --pm-text-muted: #9aa2af;

  --background: var(--pm-surface);
  --bg-color: var(--pm-bg);
  --navbar-bg-2: #171717;
}

/* Motion respect */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}

/* =========================
   GLOBAL LAYOUT
   ========================= */
html, body { background: var(--pm-bg) !important; }
.page-container { background: var(--pm-bg) !important; }

.page-head {
  background: var(--pm-bg) !important;
  position: sticky; top: 0; z-index: 7;
  border-bottom: 1px solid color-mix(in srgb, var(--pm-border) 70%, transparent);
}

.page-content .layout-main-section {
  background: var(--pm-surface);
  border-radius: var(--pm-radius-md);
  box-shadow: var(--pm-shadow);
  padding: 16px;
}

/* Navbar */
.navbar, .navbar-light {
  height: 60px !important;
  background: var(--navbar-bg-2) !important;
}
.navbar .navbar-expand span,
.navbar .navbar-expand li a,
#navbar-breadcrumbs a { color: #fff !important; }
#navbar-breadcrumbs li.disabled a { color: #fff !important; }

/* Full-width option */
body[data-layout="full-width"] .layout-main-section-wrapper,
body[data-layout="full-width"] .page-container,
body[data-layout="full-width"] .layout-main {
  max-width: 100% !important;
  margin: 0 !important;
  padding: 0 20px !important;
}

/* =========================
   SIDEBAR (Desk)
   ========================= */
.desk-sidebar {
  width: auto !important;
  background: var(--pm-surface);
  border-right: 1px solid var(--pm-border);
  box-shadow: 2px 0 8px rgba(0,0,0,.03);
  padding: 10px 0;
}
.desk-sidebar .standard-sidebar-item {
  margin: 4px 8px;
  padding: 10px 14px;
  display: flex; align-items: center; gap: 10px;
  border-radius: var(--pm-radius-sm);
  color: var(--pm-text);
  transition: transform .15s ease, background .15s ease, color .15s ease;
}
.desk-sidebar .standard-sidebar-item a {
  display: flex; align-items: center; gap: 12px;
  font-size: 15px !important; font-weight: 500 !important; color: inherit !important;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.desk-sidebar .standard-sidebar-item svg.icon-md {
  height: 32px !important; width: 32px !important; padding: 6px !important;
}
.desk-sidebar .standard-sidebar-item:hover,
.desk-sidebar .standard-sidebar-item.selected {
  background: var(--sidebar-select-color-2) !important;
  color: var(--pm-primary) !important;
  transform: translateX(4px);
}
[data-theme="dark"] .desk-sidebar { background: #1c1c1e; border-right: 1px solid #2c2c2e; }

/* Responsive collapse behavior (paired with JS) */
.desk-sidebar.collapsed { width: 0 !important; overflow: hidden; }
.desk-sidebar.mobile-collapsed { position: fixed; inset: 0 0 0 0; width: 100%; max-width: 300px; }

/* =========================
   SEARCH
   ========================= */
.search-bar .awesomplete input {
  background: #171717; border: 1px solid var(--table-border-color-2); color: #fff;
}
[data-theme="dark"] .search-bar .awesomplete input {
  background: #2c2c2e; border-color: #3c3c3e; color: #efefef;
}

/* =========================
   FORMS + INPUTS
   ========================= */
.form-control,
.frappe-control .ql-editor:not(.read-mode),
.ace_editor {
  box-shadow: 0 0 0 1px rgba(124,124,124,.25) !important;
  border: 1px solid var(--table-border-color-2);
  background: transparent;
  border-radius: var(--pm-radius-sm);
}
.form-control:focus {
  box-shadow: 0 0 0 2px rgba(0,116,191,.5) !important;
  background: rgba(0,116,191,.08);
}

/* =========================
   BUTTONS
   ========================= */
.btn { border-radius: .375rem !important; }
.btn.btn-primary {
  color: #fff; border: 2px solid var(--pm-primary) !important; background: var(--pm-primary) !important;
}
.btn.btn-primary:hover { background: transparent !important; color: var(--pm-primary) !important; }
.standard-actions .btn.btn-secondary {
  background: var(--pm-secondary) !important; border: 2px solid var(--pm-secondary) !important; color: #fff;
}

/* =========================
   LISTS
   ========================= */
.level.list-row-head { font-weight: 700; background: #f3f4f6; }
.list-row-container .list-row:hover { background: var(--sidebar-select-color-2); }
.list-filters { position: sticky; top: 60px; z-index: 6; background: var(--pm-surface); box-shadow: 0 1px 0 var(--pm-border); }

/* =========================
   PROJECT MANAGEMENT UI
   ========================= */
/* Status chip */
.pm-chip {
  display: inline-flex; align-items: center; gap: .4ch;
  padding: 4px 8px; border-radius: 999px;
  font-size: var(--pm-font-size-sm); font-weight: 600; line-height: 1;
  border: 1px solid var(--pm-border); background: rgba(0,0,0,.03); color: var(--pm-text);
}
.pm-chip[data-status="Backlog"]{
  background: color-mix(in srgb, var(--pm-status-backlog) 14%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-backlog) 38%, transparent);
}
.pm-chip[data-status="To Do"], .pm-chip[data-status="Open"]{
  background: color-mix(in srgb, var(--pm-status-todo) 18%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-todo) 42%, transparent);
  color: #0f172a;
}
.pm-chip[data-status="In Progress"]{
  background: color-mix(in srgb, var(--pm-status-inprogress) 18%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-inprogress) 42%, transparent);
}
.pm-chip[data-status="In Review"], [data-status="Review"]{
  background: color-mix(in srgb, var(--pm-status-review) 18%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-review) 42%, transparent);
}
.pm-chip[data-status="Blocked"]{
  background: color-mix(in srgb, var(--pm-status-blocked) 16%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-blocked) 40%, transparent);
  color: #7f1d1d;
}
.pm-chip[data-status="Completed"], .pm-chip[data-status="Closed"], .pm-chip[data-status="Done"]{
  background: color-mix(in srgb, var(--pm-status-done) 16%, transparent);
  border-color: color-mix(in srgb, var(--pm-status-done) 40%, transparent);
}

/* Priority badge */
.pm-badge {
  display: inline-flex; align-items: center; padding: 2px 6px;
  border-radius: 6px; font-size: 11px; font-weight: 700; letter-spacing: .02em; text-transform: uppercase;
}
.pm-badge[data-priority="High"]{ background: color-mix(in srgb, var(--pm-pri-high) 20%, transparent); color: #7f1d1d; }
.pm-badge[data-priority="Medium"]{ background: color-mix(in srgb, var(--pm-pri-med) 20%, transparent); }
.pm-badge[data-priority="Low"]{ background: color-mix(in srgb, var(--pm-pri-low) 20%, transparent); }

/* Progress */
.pm-progress { position: relative; height: 8px; border-radius: 999px; background: #e5e7eb; overflow: hidden; }
.pm-progress > i { display: block; height: 100%; width: calc(var(--value,0) * 1%); background: linear-gradient(90deg, var(--pm-primary), var(--pm-secondary)); }

/* Inline row meta */
.list-row .pm-row-meta { display: inline-flex; gap: .5rem; align-items: center; margin-left: .75rem; }

/* Kanban (frappe kanban view) */
.kanban { --kanban-gap: 12px; }
.kanban .kanban-column {
  background: var(--pm-surface); border: 1px solid var(--pm-border);
  border-radius: var(--pm-radius-md); box-shadow: var(--pm-shadow); margin-right: var(--kanban-gap);
}
.kanban .kanban-column .kanban-header {
  padding: 10px 12px; border-bottom: 1px solid var(--pm-border);
  display: flex; align-items: center; justify-content: space-between;
}
.kanban .kanban-column .kanban-header .title { font-weight: 700; font-size: 13px; }
.kanban .kanban-column .kanban-header .count { font-size: 12px; opacity: .7; }
.kanban .kanban-card {
  border: 1px solid var(--pm-border); border-radius: var(--pm-radius-sm);
  background: var(--pm-surface); margin: 10px; padding: 10px;
  box-shadow: 0 1px 2px rgba(0,0,0,.05);
}
.kanban .kanban-card .pm-card-meta { display: flex; gap: .5rem; align-items: center; justify-content: space-between; margin-top: 8px; }

/* Gantt (frappe-gantt) */
.gantt .grid .row .grid-row, .gantt .grid .row .grid-header { stroke: var(--pm-border); }
.gantt .bar { fill: color-mix(in srgb, var(--pm-primary) 70%, #ffffff 30%); rx: 6; ry: 6; }
.gantt .bar-progress { fill: var(--pm-primary-600); }
.gantt .today-highlight { fill: color-mix(in srgb, var(--pm-secondary) 14%, transparent); }

/* Timeline (form activity) */
.timeline .timeline-item { border-left: 2px solid var(--pm-border); }
.timeline .timeline-item .timeline-badge { background: var(--pm-primary); }

/* =========================
   COMMAND PALETTE + FAB
   ========================= */
.pm-cmdk-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,.35); backdrop-filter: blur(4px);
  display: none; z-index: 9999;
}
.pm-cmdk {
  width: min(720px, 92vw); background: var(--pm-surface); border: 1px solid var(--pm-border);
  border-radius: var(--pm-radius-lg); box-shadow: var(--pm-shadow);
  margin: 10vh auto; padding: 10px;
}
.pm-cmdk .pm-cmdk-input {
  width: 100%; padding: 12px 14px; border: 1px solid var(--pm-border);
  background: transparent; border-radius: var(--pm-radius-sm); font-size: 15px; color: var(--pm-text);
}
.pm-cmdk .pm-cmdk-list { max-height: 50vh; overflow: auto; margin-top: 8px; }
.pm-cmdk .pm-cmdk-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 12px; border-radius: var(--pm-radius-sm); cursor: pointer;
}
.pm-cmdk .pm-cmdk-item:hover, .pm-cmdk .pm-cmdk-item[aria-selected="true"] { background: var(--sidebar-select-color-2); }
.pm-kbd { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; border: 1px solid var(--pm-border); padding: 2px 6px; border-radius: 4px; font-size: 11px; }

.pm-fab { position: fixed; right: 18px; bottom: 18px; z-index: 9998; }
.pm-fab button {
  height: 48px; width: 48px; border-radius: 999px; border: none;
  background: var(--pm-primary); color: #fff; box-shadow: var(--pm-shadow); cursor: pointer;
}
.pm-fab .pm-fab-menu { position: absolute; bottom: 56px; right: 0; display: none; flex-direction: column; gap: 8px; }
.pm-fab .pm-fab-menu .pm-fab-action {
  white-space: nowrap; background: var(--pm-surface); color: var(--pm-text);
  border: 1px solid var(--pm-border); padding: 8px 10px; border-radius: 8px; box-shadow: var(--pm-shadow); cursor: pointer;
}
.pm-fab.open .pm-fab-menu { display: flex; }

/* =========================
   LOGIN POLISH
   ========================= */
[data-path="login"] .navbar-light { border-bottom: 1px solid var(--pm-primary) !important; background: var(--navbar-bg-2); }
.for-login .page-card { border: 1px solid var(--pm-primary) !important; border-radius: 26px !important; box-shadow: var(--pm-shadow); }
#page-login { background: linear-gradient(45deg, #0073bf1e, #0073bf3d, #0073bf6c, #0073bfa4); min-height: 100dvh; }
